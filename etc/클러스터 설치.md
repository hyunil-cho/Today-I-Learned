1. 네트워크 관련 설정

net.ipv4.ip_forward = 1
  1. 파드 네트워킹을 위해 필요! 
  2. 통신 파드가 다른 호스트 머신에 위치한 경우, 호스트는 자신의 가상 브리지로 들어온 패킷을 외부로 '포워딩'할 수 있어야 함
  3. 이를 위해서는 해당 옵션이 활성화되어야 함

net.bridge.bridge-nf-call-iptables = 1

 1. 파드는 기본적으로 호스트 상에서 가상 브리지를 통해 통신을 수행함
 2. 위 옵션을 설정하지 않으면, 가상 브리지 내에서 오고가는 패킷이 호스트 머신의 iptables 규칙을 우회하게 됨
 3. 이로 인하여 network policy, kube-proxy 등이 설정한 네트워크 규칙이 적용되지 않아 통신이 정상적으로 동작하지 않을 수 있음

적용 방법 : 

sudo vi /etc/sysctl.conf
net.ipv4.ip_forward = 1
net.bridge.bridge-nf-call-iptables = 1
sudo sysctl -p

확인 방법:
sysctl net.ipv4.ip_forward 
sysctl net.bridge.bridge-nf-call-iptables

2. swap memory 설정

kubelet이 내부 pod의 자원 상황을 관리하기 위하여 swap memory 영역을 꺼두어야 함!

적용 방법
sudo vi /etc/fstab
내부에서, swap과 관련된 부분은 모두 주석 처리 필요

예: # /dev/mapper/centos-swap swap                    swap    defaults        0 0

3. Cgorups

kubelet과 컨테이너 런타임(예: Docker, Containerd)이 서로 다른 cgroups 드라이버를 사용하면 시스템 자원 관리에 충돌이 발생하여 Pod가 비정상적으로 종료되거나 불안정해지기 때문에  두 컴포넌트가 동일한 cgroups 드라이버를 사용하도록 설정해야 합니다.

systemd 드라이버 (권장): 대부분의 최신 리눅스 배포판에서 기본적으로 systemd가 cgroups를 관리합니다. 따라서 kubelet과 컨테이너 런타임 모두 systemd 드라이버를 사용하도록 설정해야 함

container runtime 설치 시, kubelet의 cgroup과 꼭 맞춰서 설치해야 함! 이와 관련하여는, 각 런타임 문서 상에서 설정 방법 확인

